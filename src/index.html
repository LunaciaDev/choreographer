<!doctype html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script type="module" src="js/main.ts"></script>
        <title>Choreographer</title>
    </head>

    <template id="item-section-template">
        <div class="item-section">
            <h3 class="item-section-title"></h3>
            <div class="item-section-cards"></div>
        </div>
    </template>

    <template id="item-card-template">
        <div class="item-card">
            <div class="item-card-line">
                <img class="item-image" />
                <div class="item-name"></div>
                <div class="item-amount"></div>
            </div>
            <div class="item-card-line">
                <div class="item-cost"></div>
            </div>
            <div class="item-card-line">
                <div class="item-priority"></div>
                <button class="remove-card">Delete</button>
            </div>
        </div>
    </template>

    <template id="result-item-card">
        <div class="item-card">
            <div class="item-card-line">
                <img class="item-image" />
                <div class="item-name"></div>
                <div class="item-amount"></div>
            </div>
        </div>
    </template>

    <template id="manu-item-line-template">
        <div class="manu-item-line">
            <img class="item-image" />
            <div class="manu-item-name"></div>
            <button class="remove-line">X</button>
        </div>
    </template>

    <body>
        <header>
            <div id="app-name">
                Choreographer v1.0.1<br />Foxhole 1.63 "Airborne"
            </div>
            <div id="title">Home</div>
            <button id="start-config-button" class="accent">
                Configure New Session
            </button>
            <button id="start-manu-button" class="hidden">Start Manu</button>
            <button id="stop-manu-button" class="hidden">Stop Manu</button>
            <button id="return-button" class="hidden">Return</button>
        </header>
        <main>
            <div id="stat-view" class="">
                <div id="stat-import-export-overlay" class="hidden">
                    <div class="overlay-content">
                        <div id="stat-import-data">
                            <h3>Import Data</h3>
                            <label for="stat-import-data-input"
                                >Paste user data here:</label
                            >
                            <textarea id="stat-import-data-input"></textarea>
                            <div class="hidden" id="stat-import-error"></div>
                            <button id="stat-import-confirm">Import</button>
                        </div>
                        <div id="stat-export-data">
                            <h3>Export Data</h3>
                            <label for="stat-export-data-output"
                                >Your user data is here for copying:</label
                            >
                            <textarea
                                id="stat-export-data-output"
                                readonly
                            ></textarea>
                            <label for="stat-reset-data-output"
                                >If you want to reset your data, use this
                                instead:</label
                            >
                            <textarea
                                id="stat-reset-data-output"
                                readonly
                            ></textarea>
                        </div>
                    </div>
                </div>
                <div class="stat-button-group group">
                    <button id="import-export-stat">Import/Export Data</button>
                    <button id="stat-reset-current-war">
                        Reset Current War Stat
                    </button>
                </div>
                <h2 class="stat-header">Lifetime Statistics</h2>
                <div class="table stat-basic">
                    <div class="table-item">
                        <div class="item-value" id="stat-crate-count"></div>
                        <div class="item-description">crates manufactured</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="stat-time-spent"></div>
                        <div class="item-description">spent manufacturing</div>
                    </div>
                    <div class="table-item">
                        <div
                            class="item-value"
                            id="stat-time-hundred-crate"
                        ></div>
                        <div class="item-description">
                            to manufacture 100 crates
                        </div>
                    </div>
                </div>
                <div class="table stat-material">
                    <div class="table-item">
                        <div class="item-value" id="stat-bmat-used"></div>
                        <div class="item-description">bmat consumed</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="stat-emat-used"></div>
                        <div class="item-description">emat consumed</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="stat-hemat-used"></div>
                        <div class="item-description">hemat consumed</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="stat-rmat-used"></div>
                        <div class="item-description">rmat consumed</div>
                    </div>
                </div>
                <h2 class="stat-header">Current War Statistics</h2>
                <div class="table stat-basic">
                    <div class="table-item">
                        <div class="item-value" id="stat-war-crate-count"></div>
                        <div class="item-description">crates manufactured</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="stat-war-time-spent"></div>
                        <div class="item-description">spent manufacturing</div>
                    </div>
                    <div class="table-item">
                        <div
                            class="item-value"
                            id="stat-war-time-hundred-crate"
                        ></div>
                        <div class="item-description">
                            to manufacture 100 crates
                        </div>
                    </div>
                </div>
                <div class="table stat-material">
                    <div class="table-item">
                        <div class="item-value" id="stat-war-bmat-used"></div>
                        <div class="item-description">bmat consumed</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="stat-war-emat-used"></div>
                        <div class="item-description">emat consumed</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="stat-war-hemat-used"></div>
                        <div class="item-description">hemat consumed</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="stat-war-rmat-used"></div>
                        <div class="item-description">rmat consumed</div>
                    </div>
                </div>
            </div>
            <div id="config-view" class="hidden">
                <div id="config-logihub-help" class="hidden">
                    <div class="overlay-content">
                        <h3>
                            How to import warehouse data from Logihub/Shockbot?
                        </h3>
                        <ol>
                            <li>
                                Switch to the corresponding factory need view in
                                Logihub or Shockbot.
                            </li>
                            <li>
                                Open Developer Tools on your web browser
                                (typically <code>Ctrl + Shift + I</code>)
                            </li>
                            <li>
                                Copy and run the following JavaScript code into
                                the Console:
                                <br />
                                For Logihub:
                                <div class="codeblock">
                                    {let res =
                                    [];document.querySelectorAll('app-supply-list-item').forEach((item)
                                    => {let obj = {};let nameAndAmount =
                                    item.querySelector('.card-header').querySelectorAll('span');let
                                    priorityAndPercentage =
                                    item.querySelector('.card-footer').querySelectorAll('span');obj.name
                                    =
                                    nameAndAmount[0].innerText.trim();obj.amount
                                    =
                                    parseInt(nameAndAmount[1].innerText.trim());obj.priority
                                    =
                                    priorityAndPercentage[0].innerText.trim();obj.percentage
                                    =parseInt(priorityAndPercentage[priorityAndPercentage.length
                                    - 1].innerText.trim()) / 100;if
                                    (obj.priority.length === 0) { obj.priority =
                                    "-";
                                    }res.push(obj);});console.log(JSON.stringify(res));}
                                </div>
                                For Shockbot:
                                <div class="codeblock">
                                    {let res =
                                    [];document.querySelector("[role='dialog']").lastChild.lastChild.childNodes.forEach((item)
                                    => {let obj = {};let name =
                                    item.querySelector('span').innerText;let
                                    value =
                                    item.querySelector('div').innerText.split("/").map((value)
                                    => parseInt(value));if (value[0] > value[1])
                                    { return; }if (name === "Maintenance
                                    Supplies") { return; }if (name === "250mm
                                    Shell") {name = '250mm "Purity"
                                    Shell'}obj.name = name;obj.priority =
                                    "-";obj.amount = value[1] -
                                    value[0];obj.percentage = value[0] /
                                    value[1];res.push(obj);});console.log(JSON.stringify(res));}
                                </div>
                                The script will:
                                <ul>
                                    <li>
                                        Get the document part showing the
                                        warehouse content
                                        (<code>'app-supply-list-item'</code>)
                                        which have a bunch of 'item cards'
                                    </li>
                                    <li>
                                        For each item card, take the name (1st
                                        span of <code>'card-header'</code> span
                                        class), the priority (1st span of
                                        <code>'card-footer'</code> span class,
                                        if it is a whitespace mean no priority),
                                        the percentage (last span of
                                        <code>'card-footer'</code> span class)
                                    </li>
                                    <li>
                                        Record all of that into a JSON object
                                        and print it out.
                                    </li>
                                </ul>
                            </li>
                            <li>
                                An export in text will be produced, copy and
                                paste it into the LogiHub import box.
                            </li>
                        </ol>
                    </div>
                </div>
                <div id="data-input">
                    <div class="table" id="data-input-table">
                        <div class="table-item">
                            <div class="item-description">
                                Import from Logihub/Shockbot
                            </div>
                            <div class="item-value" id="logihub-input">
                                <label for="logihub-import-paste"
                                    >Paste the exported data here:</label
                                >
                                <textarea
                                    id="logihub-import-paste"
                                    name="logihub-import-paste"
                                ></textarea>
                            </div>
                            <div id="config-filter-cost">
                                Allow item costing:
                                <div class="checkbox-group">
                                    <input
                                        type="checkbox"
                                        id="config-allow-bmat"
                                        checked
                                    />
                                    <label for="config-allow-bmat">bmat</label>
                                </div>
                                <div class="checkbox-group">
                                    <input
                                        type="checkbox"
                                        id="config-allow-emat"
                                        checked
                                    />
                                    <label for="config-allow-emat">emat</label>
                                </div>
                                <div class="checkbox-group">
                                    <input
                                        type="checkbox"
                                        id="config-allow-hemat"
                                        checked
                                    />
                                    <label for="config-allow-hemat"
                                        >hemat</label
                                    >
                                </div>
                                <div class="checkbox-group">
                                    <input
                                        type="checkbox"
                                        id="config-allow-rmat"
                                        checked
                                    />
                                    <label for="config-allow-rmat">rmat</label>
                                </div>
                            </div>
                            <div class="hidden" id="logihub-import-error"></div>
                            <div id="logihub-import-button-group">
                                <button
                                    class="accent"
                                    id="submit-logihub-import"
                                >
                                    Submit
                                </button>
                                <button id="config-show-logihub-help">?</button>
                            </div>
                        </div>
                        <div class="table-item">
                            <div class="item-description">Manual Entry</div>
                            <div class="item-value" id="manual-input">
                                <label for="item-name">Item name:</label>
                                <input
                                    id="item-name"
                                    list="item-names-list"
                                    name="item-name"
                                    placeholder="Type here..."
                                />
                                <datalist id="item-names-list"> </datalist>
                                <label for="priority">Priority:</label>
                                <select id="priority" name="priority">
                                    <option value="-">No Priority</option>
                                    <option value="Priority">Priority</option>
                                    <option value="High Priority">
                                        High Priority
                                    </option>
                                </select>
                                <label for="current-fill-level"
                                    >Current Fill Level:</label
                                >
                                <select id="current-fill-level">
                                    <option value="critical">Critical</option>
                                    <option value="low">Low</option>
                                    <option value="okayish">Okay-ish</option>
                                </select>
                                <label for="amount">Amount:</label>
                                <input
                                    id="amount"
                                    type="number"
                                    name="amount"
                                    min="0"
                                />
                                <div
                                    class="hidden"
                                    id="manual-import-error"
                                ></div>
                                <button class="accent" id="submit-item-button">
                                    Submit
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="data-view"></div>
            </div>
            <div id="manu-view" class="hidden">
                <div class="table" id="manu-info-table">
                    <div class="table-item">
                        <div class="item-value" id="crate-crafted"></div>
                        <div class="item-description">crates manufactured</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="cost-to-craft"></div>
                        <div class="item-description">needed to set queues</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="time-spent"></div>
                        <div class="item-description">since session start</div>
                    </div>
                </div>
                <div id="requirement-view">
                    <div id="manu-qs">Queues to set</div>
                    <div id="item-to-craft"></div>
                </div>
                <div id="manu-control">
                    <div class="line">
                        Clicks empty queues, click Submit after setting queues
                    </div>
                    <div id="manu-button-panel">
                        <div>
                            <div
                                id="rq-lightarm-popup"
                                class="manu-button-popup-hidden"
                            >
                                3
                            </div>
                            <button
                                class="manu-control-button"
                                id="rq-lightarm"
                            >
                                <img src="images/smallarm.png" />
                            </button>
                        </div>
                        <div>
                            <div
                                id="rq-heavyarm-popup"
                                class="manu-button-popup-hidden"
                            >
                                3
                            </div>
                            <button
                                class="manu-control-button"
                                id="rq-heavyarm"
                            >
                                <img src="images/heavyarm.png" />
                            </button>
                        </div>
                        <div>
                            <div
                                id="rq-heavyshell-popup"
                                class="manu-button-popup-hidden"
                            >
                                3
                            </div>

                            <button
                                class="manu-control-button"
                                id="rq-heavyshell"
                            >
                                <img src="images/heavyammo.png" />
                            </button>
                        </div>
                        <div>
                            <div
                                id="rq-utilities-popup"
                                class="manu-button-popup-hidden"
                            >
                                3
                            </div>

                            <button
                                class="manu-control-button"
                                id="rq-utilities"
                            >
                                <img src="images/utility.png" />
                            </button>
                        </div>
                        <div>
                            <div
                                id="rq-medical-popup"
                                class="manu-button-popup-hidden"
                            >
                                3
                            </div>

                            <button class="manu-control-button" id="rq-medical">
                                <img src="images/medical.png" />
                            </button>
                        </div>
                        <div>
                            <div
                                id="rq-uniform-popup"
                                class="manu-button-popup-hidden"
                            >
                                3
                            </div>

                            <button class="manu-control-button" id="rq-uniform">
                                <img src="images/uniform.png" />
                            </button>
                        </div>
                    </div>
                    <div class="line">
                        <button id="rq-crafted" class="accent">Submit</button>
                    </div>
                </div>
            </div>
            <div id="result-view" class="hidden">
                <div class="table">
                    <div class="table-item">
                        <div class="item-value" id="result-time"></div>
                        <div class="item-description">spent manufacturing</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="result-crate"></div>
                        <div class="item-description">crates manufactured</div>
                    </div>
                </div>
                <div class="table">
                    <div class="table-item">
                        <div
                            class="item-value"
                            id="result-container-equivalent"
                        >
                            4.5 trains
                        </div>
                        <div class="item-description">worth of crates!</div>
                    </div>
                </div>
                <div class="table">
                    <div class="table-item">
                        <div class="item-value" id="result-bmat-used"></div>
                        <div class="item-description">bmat consumed</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="result-emat-used"></div>
                        <div class="item-description">emat consumed</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="result-hemat-used"></div>
                        <div class="item-description">hemat consumed</div>
                    </div>
                    <div class="table-item">
                        <div class="item-value" id="result-rmat-used"></div>
                        <div class="item-description">rmat consumed</div>
                    </div>
                </div>
                <div class="result-hd">Crates Made</div>
                <div id="result-item-crafted"></div>
            </div>
        </main>
        <footer>Choreographer v1.0.1 -- Foxhole 1.63 "Airborne"</footer>
    </body>
</html>
